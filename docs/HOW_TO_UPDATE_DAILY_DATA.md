# å¦‚ä½•æ›´æ–° Daily Data - å¿«é€ŸæŒ‡å—

## ğŸ¯ æ¨è–¦æ–¹å¼ï¼ˆä½¿ç”¨ä¸»æ¨¡çµ„ï¼‰

### ä½¿ç”¨ UI æ‡‰ç”¨ç¨‹å¼ï¼ˆæœ€æ¨è–¦ â­â­â­ï¼‰

```bash
python ui_app/main.py
```

åœ¨ UI ä¸­ï¼š
1. é¸æ“‡ã€Œæ•¸æ“šæ›´æ–°ã€æ¨™ç±¤é 
2. é¸æ“‡æ›´æ–°é¡å‹ï¼ˆæ¯æ—¥/å¤§ç›¤/ç”¢æ¥­ï¼‰
3. è¨­å®šæ—¥æœŸç¯„åœ
4. é»æ“Šã€Œé–‹å§‹æ›´æ–°ã€

**å„ªé»ï¼š**
- âœ… åœ–å½¢åŒ–ç•Œé¢ï¼Œæ“ä½œç°¡å–®
- âœ… æ•´åˆæ‰€æœ‰æ›´æ–°åŠŸèƒ½
- âœ… é¡¯ç¤ºè©³ç´°æ—¥èªŒ
- âœ… è‡ªå‹•éŒ¯èª¤è™•ç†

---

### æ‰¹é‡æ›´æ–°å¤šæ—¥æ•¸æ“šï¼ˆæ¨è–¦ â­â­ï¼‰

```bash
# æ›´æ–°å¾æŒ‡å®šæ—¥æœŸä¹‹å¾Œåˆ°ä»Šå¤©çš„æ‰€æœ‰äº¤æ˜“æ—¥
python scripts/batch_update_daily_data.py --start-date 2025-08-28

# æ›´æ–°æŒ‡å®šæ—¥æœŸç¯„åœ
python scripts/batch_update_daily_data.py --start-date 2025-08-28 --end-date 2025-09-05

# è‡ªè¨‚å»¶é²æ™‚é–“ï¼ˆæ›´å®‰å…¨ï¼Œé¿å… API é™åˆ¶ï¼‰
python scripts/batch_update_daily_data.py --start-date 2025-08-28 --delay-min 4 --delay-max 4
```

**å„ªé»ï¼š**
- âœ… **ä½¿ç”¨ä¸»æ¨¡çµ„**ï¼ˆ`data_module/data_loader.py`ï¼‰
- âœ… è‡ªå‹•æ›´æ–°å¤šå€‹äº¤æ˜“æ—¥ï¼ˆæ’é™¤é€±æœ«ï¼‰
- âœ… å·²åŒ…å« delay timeï¼ˆé è¨­ 4 ç§’ï¼Œå¯èª¿æ•´ï¼‰
- âœ… è‡ªå‹•è·³éå·²å­˜åœ¨çš„æ–‡ä»¶
- âœ… é¡¯ç¤ºè©³ç´°é€²åº¦å’Œçµæœæ‘˜è¦
- âœ… çµ±ä¸€çš„æ—¥èªŒè¨˜éŒ„
- âœ… ç¬¦åˆå°ˆæ¡ˆæ¶æ§‹

---

### æ›´æ–°å–®æ—¥æ•¸æ“š

```bash
# æ›´æ–°æŒ‡å®šæ—¥æœŸçš„æ•¸æ“šï¼ˆåªæ›´æ–° daily_priceï¼‰
python scripts/update_daily_stock_data.py --date 2025-08-29

# æ›´æ–°ä¸¦è‡ªå‹•åˆä½µåˆ° meta_data
python scripts/update_daily_stock_data.py --date 2025-08-29 --merge
```

**å„ªé»ï¼š**
- âœ… **ä½¿ç”¨ä¸»æ¨¡çµ„**ï¼ˆ`data_module/data_loader.py`ï¼‰
- âœ… å·²åŒ…å« delay time å’Œ Session è™•ç†ï¼ˆé¿å… 307 éŒ¯èª¤ï¼‰
- âœ… ä½¿ç”¨æˆåŠŸé©—è­‰çš„é‚è¼¯ï¼ˆMI_INDEX API, type=ALLï¼‰
- âœ… å¯ä»¥é¸æ“‡æ˜¯å¦è‡ªå‹•åˆä½µ
- âœ… çµ±ä¸€çš„æ—¥èªŒè¨˜éŒ„
- âœ… ç¬¦åˆå°ˆæ¡ˆæ¶æ§‹

---

## ğŸ“‹ æ‰€æœ‰å¯ç”¨çš„æ›´æ–°æ–¹å¼

### æ–¹å¼ 1ï¼šUI æ‡‰ç”¨ç¨‹å¼ï¼ˆæœ€æ¨è–¦ â­â­â­ï¼‰

**ç”¨é€”ï¼š** åœ–å½¢åŒ–ç•Œé¢æ›´æ–°æ•¸æ“š

```bash
python ui_app/main.py
```

**ç‰¹é»ï¼š**
- åœ–å½¢åŒ–ç•Œé¢ï¼Œæ“ä½œç°¡å–®
- æ•´åˆæ‰€æœ‰æ›´æ–°åŠŸèƒ½ï¼ˆæ¯æ—¥/å¤§ç›¤/ç”¢æ¥­ï¼‰
- é¡¯ç¤ºè©³ç´°æ—¥èªŒ
- è‡ªå‹•éŒ¯èª¤è™•ç†

---

### æ–¹å¼ 2ï¼šscripts/batch_update_daily_data.pyï¼ˆæ¨è–¦ â­â­ï¼‰

**ç”¨é€”ï¼š** æ‰¹é‡æ›´æ–°å¤šå€‹äº¤æ˜“æ—¥çš„æ•¸æ“š

```bash
# æ›´æ–°å¾æŒ‡å®šæ—¥æœŸä¹‹å¾Œåˆ°ä»Šå¤©çš„æ‰€æœ‰äº¤æ˜“æ—¥
python scripts/batch_update_daily_data.py --start-date 2025-08-28

# æ›´æ–°æŒ‡å®šæ—¥æœŸç¯„åœ
python scripts/batch_update_daily_data.py --start-date 2025-08-28 --end-date 2025-09-05

# è‡ªè¨‚å»¶é²æ™‚é–“ï¼ˆç§’ï¼‰
python scripts/batch_update_daily_data.py --start-date 2025-08-28 --delay-min 4 --delay-max 4
```

**ç‰¹é»ï¼š**
- ä½¿ç”¨ä¸»æ¨¡çµ„ `data_module/data_loader.py` çš„ `download_from_api()` æ–¹æ³•
- è‡ªå‹•æ›´æ–°å¤šå€‹äº¤æ˜“æ—¥ï¼ˆæ’é™¤é€±æœ«ï¼‰
- å·²åŒ…å« delay timeï¼ˆé è¨­ 4 ç§’ï¼Œå¯èª¿æ•´ï¼‰
- è‡ªå‹•è·³éå·²å­˜åœ¨çš„æ–‡ä»¶
- é¡¯ç¤ºè©³ç´°é€²åº¦å’Œçµæœæ‘˜è¦
- ä½¿ç”¨ Session å’Œ cookie è™•ç†
- ä½¿ç”¨ MI_INDEX API (type=ALL)
- çµ±ä¸€çš„æ—¥èªŒè¨˜éŒ„
- ç¬¦åˆå°ˆæ¡ˆæ¶æ§‹

---

### æ–¹å¼ 3ï¼šscripts/update_daily_stock_data.pyï¼ˆæ¨è–¦ â­â­ï¼‰

**ç”¨é€”ï¼š** ä½¿ç”¨ä¸»æ¨¡çµ„æ›´æ–°å–®æ—¥æ•¸æ“š

```bash
# æ›´æ–°ä¸¦è‡ªå‹•åˆä½µ
python scripts/update_daily_stock_data.py --date 2025-08-29 --merge

# åªæ›´æ–° daily_priceï¼Œä¸åˆä½µ
python scripts/update_daily_stock_data.py --date 2025-08-29
```

**ç‰¹é»ï¼š**
- ä½¿ç”¨ä¸»æ¨¡çµ„ `data_module/data_loader.py` çš„ `download_from_api()` æ–¹æ³•
- å·²åŒ…å« delay timeï¼ˆ1.5-2.5 ç§’ï¼‰
- ä½¿ç”¨ Session å’Œ cookie è™•ç†
- ä½¿ç”¨ MI_INDEX API (type=ALL)
- çµ±ä¸€çš„æ—¥èªŒè¨˜éŒ„
- ç¬¦åˆå°ˆæ¡ˆæ¶æ§‹

---

### æ–¹å¼ 4ï¼šä½¿ç”¨ä¸»æ¨¡çµ„ï¼ˆç¨‹å¼ç¢¼æ–¹å¼ï¼‰

**ç”¨é€”ï¼š** åœ¨ Python ç¨‹å¼ä¸­ç›´æ¥ä½¿ç”¨ä¸»æ¨¡çµ„

```python
from data_module.config import TWStockConfig
from data_module.data_loader import DataLoader

config = TWStockConfig()
loader = DataLoader(config)

# æ–¹æ³• 1ï¼šåªä¸‹è¼‰æ•¸æ“šï¼ˆä¿å­˜åˆ° daily_priceï¼‰
df = loader.download_from_api("2025-08-29")

# æ–¹æ³• 2ï¼šæ›´æ–°æ•¸æ“šï¼ˆèª¿ç”¨ download_from_apiï¼‰
success = loader.update_daily_data("2025-08-29")
```

**ç‰¹é»ï¼š**
- å·²åŒ…å« delay time å’Œ Session è™•ç†
- é©åˆæ•´åˆåˆ°å…¶ä»–è…³æœ¬ä¸­
- ä½¿ç”¨ä¸»æ¨¡çµ„æ–¹æ³•

---

### æ–¹å¼ 5ï¼šåªåˆä½µæ•¸æ“šï¼ˆä¸æ›´æ–°ï¼‰

**ç”¨é€”ï¼š** åªåˆä½µå·²å­˜åœ¨çš„ daily_price æ–‡ä»¶åˆ° meta_data

```bash
python scripts/merge_daily_data.py
```

**ç‰¹é»ï¼š**
- åªåˆä½µï¼Œä¸æ›´æ–°
- è‡ªå‹•æª¢æ¸¬æ–°çš„ daily_price æ–‡ä»¶
- å¢é‡åˆä½µï¼ˆåªè™•ç†æ–°æ–‡ä»¶ï¼‰

---

## ğŸ”„ å®Œæ•´æ›´æ–°æµç¨‹

### æ¨™æº–æµç¨‹ï¼ˆæ¨è–¦ï¼‰

```bash
# æ­¥é©Ÿ 1ï¼šæ›´æ–°å–®æ—¥æ•¸æ“šï¼ˆåªæ›´æ–° daily_priceï¼‰
python scripts/update_daily_stock_data.py --date 2025-08-29

# æ­¥é©Ÿ 2ï¼šåˆä½µåˆ° meta_dataï¼ˆå¯é¸ï¼Œä¹Ÿå¯ä»¥ç´¯ç©å¤šæ—¥å¾Œå†åˆä½µï¼‰
python scripts/merge_daily_data.py
```

### ä¸€éµæ›´æ–°ï¼ˆè‡ªå‹•åˆä½µï¼‰

```bash
# æ›´æ–°ä¸¦è‡ªå‹•åˆä½µ
python scripts/update_daily_stock_data.py --date 2025-08-29 --merge
```

---

## ğŸ“ ä½¿ç”¨ç¯„ä¾‹

### ç¯„ä¾‹ 1ï¼šæ›´æ–°ä»Šå¤©çš„æ•¸æ“š

```bash
# å‡è¨­ä»Šå¤©æ˜¯ 2025-08-29
python scripts/update_daily_stock_data.py --date 2025-08-29 --merge
```

### ç¯„ä¾‹ 2ï¼šæ›´æ–°æ˜¨å¤©çš„æ•¸æ“šï¼ˆåªæ›´æ–°ï¼Œä¸åˆä½µï¼‰

```bash
python scripts/update_daily_stock_data.py --date 2025-08-28
```

### ç¯„ä¾‹ 3ï¼šæ‰¹é‡æ›´æ–°å¤šæ—¥æ•¸æ“šï¼ˆæ¨è–¦ï¼‰

```bash
# æ›´æ–°å¾ 8/28 ä¹‹å¾Œåˆ°ä»Šå¤©çš„æ‰€æœ‰äº¤æ˜“æ—¥
python scripts/batch_update_daily_data.py --start-date 2025-08-28

# æ›´æ–°å¾Œåˆä½µæ‰€æœ‰æ–°æ•¸æ“š
python scripts/merge_daily_data.py
```

---

## âš ï¸ æ³¨æ„äº‹é …

1. **æ—¥æœŸæ ¼å¼ï¼š** å¿…é ˆä½¿ç”¨ `YYYY-MM-DD` æ ¼å¼ï¼ˆå¦‚ `2025-08-29`ï¼‰

2. **äº¤æ˜“æ—¥ï¼š** åªèƒ½æ›´æ–°äº¤æ˜“æ—¥ï¼ˆé€±æœ«å’Œå‡æ—¥æœƒå¤±æ•—ï¼‰

3. **å»¶é²æ™‚é–“ï¼š** 
   - å–®æ—¥æ›´æ–°ï¼šæ¯æ¬¡è«‹æ±‚æœƒè‡ªå‹•å»¶é² 1.5-2.5 ç§’
   - æ‰¹é‡æ›´æ–°ï¼šé è¨­ 4 ç§’ï¼ˆå¯èª¿æ•´ï¼‰ï¼Œè«‹è€å¿ƒç­‰å¾…

4. **æ‰¹é‡æ›´æ–°ï¼š** 
   - æ¨è–¦ä½¿ç”¨ `batch_update_daily_data.py` æ‰¹é‡æ›´æ–°
   - è‡ªå‹•è·³éå·²å­˜åœ¨çš„æ–‡ä»¶ï¼Œå¯å®‰å…¨é‡æ–°åŸ·è¡Œ
   - æ›´æ–°å®Œæˆå¾Œå†çµ±ä¸€åˆä½µ

5. **å‚™ä»½ï¼š** åˆä½µå‰æœƒè‡ªå‹•å‰µå»ºå‚™ä»½ï¼Œä¸ç”¨æ“”å¿ƒæ•¸æ“šä¸Ÿå¤±

---

## ğŸ†˜ é‡åˆ°å•é¡Œæ™‚

### å•é¡Œ 1ï¼šHTTP 307 éŒ¯èª¤
â†’ ä½¿ç”¨ UI æ‡‰ç”¨ç¨‹å¼æˆ–ä¸»æ¨¡çµ„è…³æœ¬ï¼ˆå·²åŒ…å«è™•ç†ï¼‰

### å•é¡Œ 2ï¼šAPI è¿”å›éŒ¯èª¤ç‹€æ…‹
â†’ æª¢æŸ¥æ—¥æœŸæ˜¯å¦ç‚ºäº¤æ˜“æ—¥ï¼Œæ—¥æœŸæ ¼å¼æ˜¯å¦æ­£ç¢º

### å•é¡Œ 3ï¼šæ•¸æ“šç‚ºç©º
â†’ æŸ¥çœ‹ `docs/DATA_FETCHING_LOGIC.md` çš„éŒ¯èª¤æ’æŸ¥æŒ‡å—

---

## ğŸ“š ç›¸é—œæ–‡æª”

- **`docs/DATA_FETCHING_LOGIC.md`** - æ•¸æ“šç²å–é‚è¼¯è©³ç´°èªªæ˜
- **`docs/current_issues.md`** - ç•¶å‰å·²çŸ¥å•é¡Œå’Œè§£æ±ºæ–¹æ¡ˆ
- **`docs/data_collection_architecture.md`** - æ•¸æ“šæ”¶é›†æ¶æ§‹èªªæ˜
- **`ui_app/README.md`** - UI æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨èªªæ˜

